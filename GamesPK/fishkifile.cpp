#include <windows.h>
#include <iostream>
#include <ctime>
#include <string>
#include <conio.h>
#include <fstream>
#include <set>
#include <map>
#include <cstdlib>
#include <chrono>
#include <random>
#include <mmsystem.h>
#include <thread>

using namespace std;
extern bool music;
extern bool sounds;
extern HANDLE hConsole;
int read(string msg, int b, int e);
string readstr(string msg);
void playsound(string soundname, string musicalias);
class MyException {};

string namepicf =
R"(
      (@@@@*      @@@*   @@@@&  @@@@  %@@@   @@@%  @@@@  @@@@@ @@@@    @@@@
  @@@@&@@@%@@@@%  @@@*  @@@@@&  @@@@  %@@@   @@@%  @@@@ @@@*   @@@@  @@@@@@
  @@@  @@@% @@@@  @@@*@@@@@@@&  @@@@  %@@@   @@@%  @@@@@@@     @@@@@@@@@@@@
  @@@@@@@@@@@@@.  @@@@@@  @@@&  @@@@  %@@@   @@@%  @@@@ @@@@   @@@@@@  @@@@
       @@@%       @@@@    @@@&  @@@@@@@@@@@@@@@@%  @@@@  @@@@, @@@@@   @@@@)";
const string comppicc =
R"(  
       ____________________________
      !\_________________________/!\
      !!                         !! \
      !!                         !!  \
      !!                         !!  !
      !!                         !!  !
      !!         лни унд         !!  !
      !!                         !!  !
      !!                         !!  !
      !!                         !!  /
      !!_________________________!! /
      !/_________________________\!/
         __\_________________/__/!_
        !_______________________!/
      ________________________
     /oooo  oooo  oooo  oooo /!
    /ooooooooooooooooooooooo/ /
   /ooooooooooooooooooooooo/ /
  /C=_____________________/_/     
)";
//HANDLE  hConsole;
int check(set<int>& player, set<int>& comp)
{
	set<int> winpos[8] =
	{
		{2, 4, 9},
		{3, 5, 7},
		{1, 6, 8},
		{2, 6, 7},
		{1, 5, 9},
		{3, 4, 8},
		{2, 5, 8},
		{4, 5, 6}
	};
	set<int> tempp, tempc;
	if (player.size() + comp.size() == 9)
		return 0;
	for (int i = 0; i < 8; i++)
	{
		tempp.clear();
		tempc.clear();
		set_intersection(player.begin(), player.end(), winpos[i].begin(), winpos[i].end(), inserter(tempp, tempp.begin()));
		set_intersection(comp.begin(), comp.end(), winpos[i].begin(), winpos[i].end(), inserter(tempc, tempc.begin()));
		if (tempp.size() == 3)
			return 1;
		if (tempc.size() == 3)
			return -1;
	}
	return 2;
}
int playg(set<int>& player, set<int>& comp)
{

	set<int> tempp, tempc;
	random_device rd;
	mt19937 mersenne(rd());
	set<int> winpos[8] =
	{
		{2, 4, 9},
		{3, 5, 7},
		{1, 6, 8},
		{2, 6, 7},
		{1, 5, 9},
		{3, 4, 8},
		{2, 5, 8},
		{4, 5, 6}
	};

	if (player.size() == 1 && player.find(5) != player.end() && comp.size() == 0)
	{
		int t1 = ((unsigned int)mersenne() % 4 + 1) * 2;
		comp.insert(t1);
		return t1;
	}
	else if (player.size() == 1 && player.find(5) == player.end() && comp.size() == 0 || player.size() == 0 && comp.size() == 0)
	{
		comp.insert(5);
		return 5;
	}
	else if (player.size() == 1 && player.find(2) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
	{
		comp.insert(8);
		return 8;
	}
	else if (player.size() == 1 && player.find(4) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
	{
		comp.insert(6);
		return 6;
	}
	else if (player.size() == 1 && player.find(6) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
	{
		comp.insert(4);
		return 4;
	}
	else if (player.size() == 1 && player.find(8) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
	{
		comp.insert(2);
		return 2;
	}
	else if (player.size() == 1 && player.find(1) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
	{
		int t1 = 2 + ((unsigned int)mersenne() % 2) * 2;
		comp.insert(t1);
		return t1;
	}
	else if (player.size() == 1 && player.find(3) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
	{
		int t1 = 2 + ((unsigned int)mersenne() % 2) * 4;
		comp.insert(t1);
		return t1;
	}
	else if (player.size() == 1 && player.find(7) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
	{
		int t1 = 4 + ((unsigned int)mersenne() % 2) * 4;
		comp.insert(t1);
		return t1;
	}
	else if (player.size() == 1 && player.find(9) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
	{
		int t1 = 6 + ((unsigned int)mersenne() % 2) * 2;
		comp.insert(t1);
		return t1;
	}
	else if (player.size() == 2 && player.find(1) != player.end() && player.find(3) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
		for (int i = 0; i < 4; i++)
		{
			int t1 = ((unsigned int)mersenne() % 4 + 1) * 2;
			if (t1 > 8)
				t1 = 2;
			if (player.find(t1) == player.end() && comp.find(t1) == comp.end() && t1 != 2)
			{
				comp.insert(t1);
				return t1;
			}
			t1 += 2;
		}
	else if (player.size() == 2 && player.find(1) != player.end() && player.find(7) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
		for (int i = 0; i < 4; i++)
		{
			int t1 = ((unsigned int)mersenne() % 4 + 1) * 2;
			if (t1 > 8)
				t1 = 2;
			if (player.find(t1) == player.end() && comp.find(t1) == comp.end() && t1 != 4)
			{
				comp.insert(t1);
				return t1;
			}
			t1 += 2;
		}
	else if (player.size() == 2 && player.find(7) != player.end() && player.find(9) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
		for (int i = 0; i < 4; i++)
		{
			int t1 = ((unsigned int)mersenne() % 4 + 1) * 2;
			if (t1 > 8)
				t1 = 2;
			if (player.find(t1) == player.end() && comp.find(t1) == comp.end() && t1 != 8)
			{
				comp.insert(t1);
				return t1;
			}
			t1 += 2;
		}
	else if (player.size() == 2 && player.find(9) != player.end() && player.find(3) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
		for (int i = 0; i < 4; i++)
		{
			int t1 = ((unsigned int)mersenne() % 4 + 1) * 2;
			if (t1 > 8)
				t1 = 2;
			if (player.find(t1) == player.end() && comp.find(t1) == comp.end() && t1 != 6)
			{
				comp.insert(t1);
				return t1;
			}
			t1 += 2;
		}
	else if (player.size() == 2 && comp.size() == 2 && comp.find(5) != comp.end())
	{
		int a[2] = { 0, 0 };
		int k = 0;
		int chet, nechet;
		for (auto j : player)
		{
			a[k] = j;
			k++;
		}
		if ((a[0] + a[1]) % 2 == 1)
		{
			if (a[0] % 2 == 0)
			{
				chet = a[0];
				nechet = a[1];
			}
			else
			{
				chet = a[1];
				nechet = a[0];
			}
			if (nechet == 1)
				if (chet == 2 && comp.find(4) == comp.end())
				{
					comp.insert(4);
					return 4;
				}
				else if(chet == 4 && comp.find(2) == comp.end())
				{
					comp.insert(2);
					return 2;
				}
			else if (nechet == 3)
				if (chet == 2 && comp.find(6) == comp.end())
				{
					comp.insert(6);
					return 6;
				}
				else if (chet == 6 && comp.find(2) == comp.end())
				{
					comp.insert(2);
					return 2;
				}
			else if (nechet == 7)
				if (chet == 4 && comp.find(8) == comp.end())
				{
					comp.insert(8);
					return 8;
				}
				else if (chet == 8 && comp.find(4) == comp.end())
				{
					comp.insert(4);
					return 4;
				}
			else if (nechet == 9)
				if (chet == 8 && comp.find(6) == comp.end())
				{
					comp.insert(6);
					return 6;
				}
				else if (chet == 6 && comp.find(8) == comp.end())
				{
					comp.insert(8);
					return 8;
				}
		}

	}
	if (player.size() == 2 && player.find(9) != player.end() && player.find(3) != player.end() && comp.size() == 1 && comp.find(5) != comp.end())
		for (int i = 0; i < 4; i++)
		{
			int t1 = ((unsigned int)mersenne() % 4 + 1) * 2;
			if (t1 > 8)
				t1 = 2;
			if (player.find(t1) == player.end() && comp.find(t1) == comp.end() && t1 != 6)
			{
				comp.insert(t1);
				return t1;
			}
			t1 += 2;
		}
	else
	{

		for (int i = 0; i < 8; i++)
		{
			tempp.clear();
			tempc.clear();
			set_intersection(player.begin(), player.end(), winpos[i].begin(), winpos[i].end(), inserter(tempp, tempp.begin()));
			set_intersection(comp.begin(), comp.end(), winpos[i].begin(), winpos[i].end(), inserter(tempc, tempc.begin()));

			if (tempc.size() == 2 && tempp.size() == 0)
			{
				tempp.clear();
				set_difference(winpos[i].begin(), winpos[i].end(), tempc.begin(), tempc.end(), inserter(tempp, tempp.begin()));
				for (auto j : tempp)
				{
					comp.insert(j);
					return j;
				}
			}
		}
		for (int i = 0; i < 8; i++)
		{
			tempp.clear();
			tempc.clear();
			set_intersection(player.begin(), player.end(), winpos[i].begin(), winpos[i].end(), inserter(tempp, tempp.begin()));
			set_intersection(comp.begin(), comp.end(), winpos[i].begin(), winpos[i].end(), inserter(tempc, tempc.begin()));

			if (tempp.size() == 2 && tempc.size() == 0)
			{
				tempc.clear();
				set_difference(winpos[i].begin(), winpos[i].end(), tempp.begin(), tempp.end(), inserter(tempc, tempc.begin()));
				for (auto j : tempc)
				{
					comp.insert(j);
					return j;
				}
			}
		}

		int t1 = ((unsigned int)mersenne() % 4 + 1) * 2;
		for (int i = 0; i < 4; i++)
		{
			if (t1 > 8)
				t1 = 2;
			if (player.find(t1) == player.end() && comp.find(t1) == comp.end())
			{
				comp.insert(t1);
				return t1;
			}
			t1 += 2;
		}
		t1 = ((unsigned int)mersenne() % 5 + 1) * 2 - 1;
		for (int i = 0; i < 4; i++)
		{
			if (t1 > 9)
				t1 = 1;
			if (t1 == 5)
				t1 = 7;
			if (player.find(t1) == player.end() && comp.find(t1) == comp.end())
			{
				comp.insert(t1);
				return t1;
			}
			t1 += 2;
		}
	}
}
void drawFishki(set<int>& f)
{
	cout << "  ";
	for (int i = 0; i < f.size(); i++)
		cout << "   -----   " << " ";
	cout << "\n  ";
	for (int i = 0; i < f.size(); i++)
		cout << " /       \\ " << " ";
	cout << "\n  ";
	for (int i = 0; i < 10; i++)
	{
		if (f.find(i) != f.end())
			cout << " |   " << i << "   | " << " ";
	}
	cout << "\n  ";
	for (int i = 0; i < f.size(); i++)
		cout << " \\       / " << " ";
	cout << "\n  ";
	for (int i = 0; i < f.size(); i++)
		cout << "   -----   " << " ";
	cout << "  ";
}

void PVI3()
{
	system("cls");
	//int count = 0;
	int i = 25;
	random_device rd;
	mt19937 mersenne(rd());
	//string temp = formnumber();
	set<int> winpos[8] =
	{
		{2, 4, 9},
		{3, 5, 7},
		{1, 6, 8},
		{2, 6, 7},
		{1, 5, 9},
		{3, 4, 8},
		{2, 5, 8},
		{4, 5, 6}
	};
	set<int> fishkibili = { 1, 2, 3, 4, 5, 6, 7, 8, 9 }, player, comp;
	cout << namepicf;
	cout << "\n\n\n" << endl;
	cout << "  яЕИВЮЯ ЯКСВЮИМШЛ НАПЮГНЛ АСДЕР БШАПЮМН, ЙНЛС ОНБЕГКН, Х ЙРН АСДЕР УНДХРЭ ОЕПБШЛ. \n" << endl;
	int temp = (unsigned int)mersenne() % 2;
	bool hod = false;
	int fishka;
	Sleep(1000);
	if (temp)
	{
		cout << "  й ЛНЕЛС ЯНФЮКЕМХЧ, ОЕПБШЛХ УНДХРЕ бШ...\n  ";
		system("pause");
	}
	else
	{
		cout << "\n  спю! ъ унфс оепбшл!\n  ";
		system("pause");
		system("cls");
		hod = true;
	}
	int vibor;
	bool flag = false;
	while (true)
	{
		set<int> tempp, tempc;
		if (player.size() + comp.size() == 9)
		{
			system("cls");
			cout << "\n  мхвэъ\n\n  бЮЬХ ТХЬЙХ: ";
			for (auto i : player)
				cout << i << " ";
			cout << "\n  лНХ ТХЬЙХ: ";
			for (auto i : comp)
				cout << i << " ";
			cout << "\n\n  мХЙРН МЕ ЯЛНЦ ЯНАПЮРЭ С ЯЕАЪ РПХ ТХЬЙХ Я ЯСЛЛНИ 15";
			cout << "\n  ";
			system("pause");
			break;
		}
		for (int i = 0; i < 8; i++)
		{
			tempp.clear();
			tempc.clear();
			set_intersection(player.begin(), player.end(), winpos[i].begin(), winpos[i].end(), inserter(tempp, tempp.begin()));
			set_intersection(comp.begin(), comp.end(), winpos[i].begin(), winpos[i].end(), inserter(tempc, tempc.begin()));
			if (tempp.size() == 3)
			{
				system("cls");
				cout << "\n  опхлхре лнх онгдпюбкемхъ! бш бшхцпюкх!";
				cout << "\n\n  бЮЬХ ТХЬЙХ: ";
				for (auto i : player)
					cout << i << " ";
				cout << "\n  лНХ ТХЬЙХ: ";
				for (auto i : comp)
					cout << i << " ";
				cout << "\n\n  бШ ЯНАПЮКХ С ЯЕАЪ РПХ ТХЬЙХ Я ЯСЛЛНИ 15: ";
				for (auto i : tempp)
					cout << i << " ";
				playsound("win.mp3", "gfive");
				cout << "\n  ";
				system("pause");
				flag = true;
				break;
			}
			if (tempc.size() == 3)
			{
				system("cls");
				cout << "\n  ъ онаедхк! мс ю бш опнхцпюкх :(";
				cout << "\n\n  бЮЬХ ТХЬЙХ: ";
				for (auto i : player)
					cout << i << " ";
				cout << "\n  лНХ ТХЬЙХ: ";
				for (auto i : comp)
					cout << i << " ";
				cout << "\n\n  ъ ЯНАПЮК С ЯЕАЪ РПХ ТХЬЙХ Я ЯСЛЛНИ 15: ";
				for (auto i : tempc)
					cout << i << " ";
				playsound("sadtrom.mp3", "gfive");
				cout << "\n  ";
				system("pause");
				flag = true;
				break;
			}
		}
		if (flag)
			break;
		if (hod)
		{
			system("cls");
			cout << comppicc;
			cout << endl;
			Sleep(1000);
			fishka = playg(player, comp);
			cout << "  ъ БНГЭЛС ТХЬЙС Я МНЛЕПНЛ " << fishka << "\n  ";
			fishkibili.erase(fishka);
			hod = false;
			system("pause");
			continue;
		}
		system("cls");
		cout << endl;
		cout << "  лнх тхьйх" << endl;
		drawFishki(comp);
		cout << endl;
		cout << "  нярюбьхеяъ тхьйх" << endl;
		drawFishki(fishkibili);
		cout << endl;
		cout << "  бюьх тхьйх" << endl;
		drawFishki(player);
		cout << endl;
		cout << "  бЮЬЮ НВЕПЕДЭ АПЮРЭ ТХЬЙС. бБЕДХРЕ МНЛЕП ТХЬЙХ, ЙНРНПСЧ бШ УНРХРЕ БГЪРЭ.\n  ";
		string str = "";
		char ch;
		int vibor;
		int tmp = 0;
		cout << "  ";
		while (_kbhit()) _getch();
		while (true)
		{
			SetConsoleTextAttribute(hConsole, 8);cout << "\n  (еЯКХ бШ УНРХРЕ БШИРХ ХГ ХЦПШ ББЕДХРЕ \"БШУНД\")\n  ";SetConsoleTextAttribute(hConsole, 14);
			while (cin.get(ch))
			{
				if (ch == '\n')
					break;
				str += ch;
			}
			if (str == "БШУНД")
				throw MyException();
			try
			{
				vibor = stoi(str);
				if (vibor >= 1 && vibor <= 9 && fishkibili.find(vibor) != fishkibili.end())
					break;
			}
			catch (...)
			{
				vibor = 0;
			}
			system("cls");
			if (tmp == 40)
			{
				mciSendString(L"stop all", NULL, 0, NULL);
				mciSendString(L"play \"audio/tnt.mp3\" wait", NULL, 0, NULL);
				exit(0);
			}
			if (tmp > 20)
				cout << "щРН МЕ ЙКХЙЙЕП! дН ОЕПЕЦПЕБЮ: " << 40 - tmp << endl;
			else if (tmp > 5)
				cout << "мС ЙЮЙ РЮЙ-РН? бШ МЕ ЛНФЕРЕ ОНОЮЯРЭ ОН ЙМНОЙЕ СФЕ БНР ЯРНКЭЙН ПЮГ: " << tmp << endl;
			system("cls");
			cout << endl;
			cout << "  лнх тхьйх" << endl;
			drawFishki(comp);
			cout << endl;
			cout << "  нярюбьхеяъ тхьйх" << endl;
			drawFishki(fishkibili);
			cout << endl;
			cout << "  бюьх тхьйх" << endl;
			drawFishki(player);
			cout << endl;
			cout << "  бЮЬЮ НВЕПЕДЭ АПЮРЭ ТХЬЙС. бБЕДХРЕ МНЛЕП ТХЬЙХ, ЙНРНПСЧ бШ УНРХРЕ БГЪРЭ.\n";
			//drawmatches(i);
			// cout<< endl << endl;
			//cout << "  нярюкняэ яохвей (ЕЯКХ КЕМЭ ЯВХРЮРЭ): " << i << endl;
			//cout << "  хЦПНЙ " << (temp ? name1 : name2) << ", бЮЬЮ НВЕПЕДЭ АПЮРЭ ЯОХВЙХ: 1 - БГЪРЭ НДМС, 2 - БГЪРЭ ДБЕ, 4 - БГЪРЭ ВЕРШПЕ.\n";
			if (vibor > 0 && vibor < 10 && fishkibili.find(vibor) == fishkibili.end())
			{
				cout << "  щРС ТХЬЙС СФЕ БГЪКХ. бШАЕПХРЕ ДПСЦСЧ.\n";
			}
				cout << "  оНУНФЕ БШ ББЕКХ ВРН-РН МЕ РН. оНОПНАСИРЕ ЕЫЕ ПЮГНЙ.\n  ";
			tmp++;
			str = "";
			playsound("negative.mp3", "");
		}
		//while (_kbhit()) _getch();
		//cin >> vibor;
		//int tmp = 0;
		//while (!cin.good() || (vibor < 1 && vibor > 9) || fishkibili.find(vibor) == fishkibili.end())
		//{
		//	if (vibor > 0 && vibor < 10 && fishkibili.find(vibor) == fishkibili.end())
		//	{
		//		cout << "щРС ТХЬЙС СФЕ БГЪКХ. бШАЕПХРЕ ДПСЦСЧ." << endl;
		//	}
		//	else
		//	{
		//		if (tmp == 40)
		//			exit(0);
		//		if (tmp > 20)
		//			cout << "щРН МЕ ЙКХЙЙЕП! дН ОЕПЕЦПЕБЮ: " << 40 - tmp << endl;
		//		else if (tmp > 5)
		//			cout << "мС ЙЮЙ РЮЙ-РН? рШ МЕ ЛНФЕЬЭ ОНОЮЯРЭ ОН ЙМНОЙЕ СФЕ БНР ЯРНКЭЙН ПЮГ: " << tmp << endl;
		fishkibili.erase(vibor);
		player.insert(vibor);
		cout << "  уНПНЬН." << endl;
		hod = true;
		Sleep(1000);
	}
}
void PVP3()
{
	string voprosi = "";
	random_device rd;
	mt19937 mersenne(rd());
	system("cls");
	cout << namepicf;
	cout << "\n\n\n" << endl;
	cout << "  оЕПЕД РЕЛ ЙЮЙ МЮВЮРЭ ХЦПС, МЕАНУНДХЛН БШАПЮРЭ, ЙРН АСДЕР ГЮЦЮДШБЮРЭ ВХЯКН.\n  дКЪ ЩРНЦН БЮЛ МСФМН ББЕЯРХ БЮЬХ ХЛЕМЮ." << endl;
	string name1, name2;
	//Sleep(1000);
	cout << endl << "  оЕПБШИ ХЦПНЙ ББЕДХРЕ ЯБНЕ ХЛЪ.\t";
	while (_kbhit()) _getch();
	name1 = readstr(namepicf + "\n\n\n\n  оНУНФЕ БШ ББЕКХ ВРН-РН МЕ РН. оНОПНАСИРЕ ЕЫЕ ПЮГНЙ.\n\n  оЕПБШИ ХЦПНЙ ББЕДХРЕ ЯБНЕ ХЛЪ.\t");
	cout << endl << "  гДПЮБЯРБСИРЕ, " << name1 << ". хМРЕПЕЯМНЕ ХЛЪ.\n" << endl;
	Sleep(1000);
	system("cls");
	cout << namepicf;
	cout << "\n\n\n" << endl;
	cout << "  бРНПНИ ХЦПНЙ ББЕДХРЕ ЯБНЕ ХЛЪ!\t ";
	while (_kbhit()) _getch();
	name2 = readstr(namepicf + "\n\n\n\n  оНУНФЕ БШ ББЕКХ ВРН-РН МЕ РН. оНОПНАСИРЕ ЕЫЕ ПЮГНЙ.\n\n  бРНПНИ ХЦПНЙ ББЕДХРЕ ЯБНЕ ХЛЪ.\t");
	cout << endl << "  оПХБЕРЯРБСЧ, " << name2 << ". йЮЙНЕ ГЮЛЕВЮРЕКЭМН ХЛЪ!\n\n";
	Sleep(1000);
	while (true)
	{
		set<int> winpos[8] =
		{
			{2, 4, 9},
			{3, 5, 7},
			{1, 6, 8},
			{2, 6, 7},
			{1, 5, 9},
			{3, 4, 8},
			{2, 5, 8},
			{4, 5, 6}
		};
		set<int> fishkibili = { 1, 2, 3, 4, 5, 6, 7, 8, 9 }, player, comp;
		bool hod = false;
		//int i = 25;
		system("cls");
		cout << namepicf;
		cout << "\n\n\n" << endl;
		cout << "  хЦПНЙХ, ЯЕИВЮЯ ЯКСВЮИМШЛ НАПЮГНЛ АСДЕР БШАПЮМН, ЙРН АСДЕР УНДХРЭ ОЕПБШЛ.\n\n  ";
		system("pause");
		unsigned int temp = (unsigned int)mersenne() % 2;
		int count = 0;
		system("cls");
		cout << namepicf;
		cout << "\n\n\n" << endl;
		cout << "  лНХ ОНГДПЮБКЕМХЪ, ХЦПНЙ " << (temp ? name1 : name2) << ". бШ УНДХРЕ ОЕПБШЛХ.\n  ";
		if (!temp)
		{
			hod = true;
		}
		system("pause");
		int vibor;
		bool flag = false;
		while (true)
		{
			set<int> tempp, tempc;
			if (player.size() + comp.size() == 9)
			{
				system("cls");
				cout << "\n  мхвэъ\n\nтХЬЙХ ХЦПНЙЮ " << name1 << ": ";
				for (auto i : player)
					cout << i << " ";
				cout << "\n  тХЬЙХ ХЦПНЙЮ " << name2 << ": ";
				for (auto i : comp)
					cout << i << " ";
				cout << "\n\n  мХЙРН МЕ ЯЛНЦ ЯНАПЮРЭ С ЯЕАЪ РПХ ТХЬЙХ Я ЯСЛЛНИ 15";
				cout << "\n  ";
				system("pause");
				break;
			}
			for (int i = 0; i < 8; i++)
			{
				tempp.clear();
				tempc.clear();
				set_intersection(player.begin(), player.end(), winpos[i].begin(), winpos[i].end(), inserter(tempp, tempp.begin()));
				set_intersection(comp.begin(), comp.end(), winpos[i].begin(), winpos[i].end(), inserter(tempc, tempc.begin()));
				if (tempc.size() == 3)
				{
					system("cls");
					cout << "\n  опхлхре лнх онгдпюбкемхъ хцпнй " << name1 << "! бш бшхцпюкх!";
					cout << "\n\n  тХЬЙХ ХЦПНЙЮ " << name1 << ": ";
					for (auto i : comp)
						cout << i << " ";
					cout << "\n  тХЬЙХ ХЦПНЙЮ " << name2 << ": ";
					for (auto i : player)
						cout << i << " ";
					cout << "\n\n  хЦПНЙ " << name1 << " ЯНАПЮК С ЯЕАЪ РПХ ТХЬЙХ Я ЯСЛЛНИ 15: ";
					for (auto i : tempc)
						cout << i << " ";
					playsound("win.mp3", "gfive");
					cout << "\n  ";
					system("pause");
					flag = true;
					break;
				}
				if (tempp.size() == 3)
				{
					system("cls");
					cout << "\n  опхлхре лнх онгдпюбкемхъ хцпнй " << name2 << "! бш бшхцпюкх!";
					cout << "\n\n  тХЬЙХ ХЦПНЙЮ " << name1 << ": ";
					for (auto i : comp)
						cout << i << " ";
					cout << "\n  тХЬЙХ ХЦПНЙЮ " << name2 << ": ";
					for (auto i : player)
						cout << i << " ";
					cout << "\n\n  хЦПНЙ " << name2 << " ЯНАПЮК С ЯЕАЪ РПХ ТХЬЙХ Я ЯСЛЛНИ 15: ";
					for (auto i : tempp)
						cout << i << " ";
					playsound("win.mp3", "gfive");
					cout << "\n  ";
					system("pause");
					flag = true;
					break;
				}
			}
			if (flag)
				break;
			system("cls");
			cout << endl;
			cout << "  тХЬЙХ ХЦПНЙЮ " << name1 << "\n";
			drawFishki(comp);
			cout << endl;
			cout << "  нярюбьхеяъ тхьйх" << endl;
			drawFishki(fishkibili);
			cout << endl;
			cout << "  тХЬЙХ ХЦПНЙЮ " << name2 << "\n";
			drawFishki(player);
			cout << endl;
			cout << "  хЦПНЙ " << (!hod ? name1 : name2) << " бЮЬЮ НВЕПЕДЭ АПЮРЭ ТХЬЙС.\n";
			cout << "  бЮЬЮ НВЕПЕДЭ АПЮРЭ ТХЬЙС. бБЕДХРЕ МНЛЕП ТХЬЙХ, ЙНРНПСЧ бШ УНРХРЕ БГЪРЭ.\n  ";
			string str = "";
			char ch;
			int vibor;
			int tmp = 0;
			cout << "  ";
			while (_kbhit()) _getch();
			while (true)
			{
				SetConsoleTextAttribute(hConsole, 8);cout << "\n  (еЯКХ бШ УНРХРЕ БШИРХ ХГ ХЦПШ ББЕДХРЕ \"БШУНД\")\n  ";SetConsoleTextAttribute(hConsole, 14);
				while (cin.get(ch))
				{
					if (ch == '\n')
						break;
					str += ch;
				}
				if (str == "БШУНД")
					throw MyException();
				try
				{
					vibor = stoi(str);
					if (vibor >= 1 && vibor <= 9 && fishkibili.find(vibor) == fishkibili.end())
						break;
				}
				catch (...)
				{
					vibor = 0;
				}
				system("cls");
				if (tmp == 40)
				{
					mciSendString(L"stop all", NULL, 0, NULL);
					mciSendString(L"play \"audio/tnt.mp3\" wait", NULL, 0, NULL);
					exit(0);
				}
				if (tmp > 20)
					cout << "щРН МЕ ЙКХЙЙЕП! дН ОЕПЕЦПЕБЮ: " << 40 - tmp << endl;
				else if (tmp > 5)
					cout << "мС ЙЮЙ РЮЙ-РН? бШ МЕ ЛНФЕРЕ ОНОЮЯРЭ ОН ЙМНОЙЕ СФЕ БНР ЯРНКЭЙН ПЮГ: " << tmp << endl;
				system("cls");
				cout << endl;
				cout << " тХЬЙХ ХЦПНЙЮ " << name1 << "\n";
				drawFishki(comp);
				cout << endl;
				cout << "  нярюбьхеяъ тхьйх" << endl;
				drawFishki(fishkibili);
				cout << endl;
				cout << " тХЬЙХ ХЦПНЙЮ " << name2 << "\n";
				drawFishki(player);
				cout << endl;
				cout << "  хЦПНЙ " << (!hod ? name1 : name2) << " бЮЬЮ НВЕПЕДЭ АПЮРЭ ТХЬЙС.\n";
				cout << "  бЮЬЮ НВЕПЕДЭ АПЮРЭ ТХЬЙС. бБЕДХРЕ МНЛЕП ТХЬЙХ, ЙНРНПСЧ бШ УНРХРЕ БГЪРЭ.\n";
				//drawmatches(i);
				// cout<< endl << endl;
				//cout << "  нярюкняэ яохвей (ЕЯКХ КЕМЭ ЯВХРЮРЭ): " << i << endl;
				//cout << "  хЦПНЙ " << (temp ? name1 : name2) << ", бЮЬЮ НВЕПЕДЭ АПЮРЭ ЯОХВЙХ: 1 - БГЪРЭ НДМС, 2 - БГЪРЭ ДБЕ, 4 - БГЪРЭ ВЕРШПЕ.\n";
				if (vibor > 0 && vibor < 10 && fishkibili.find(vibor) == fishkibili.end())
				{
					cout << "  щРС ТХЬЙС СФЕ БГЪКХ. бШАЕПХРЕ ДПСЦСЧ.\n";
				}
				cout << "  оНУНФЕ БШ ББЕКХ ВРН-РН МЕ РН. оНОПНАСИРЕ ЕЫЕ ПЮГНЙ.\n  ";
				tmp++;
				str = "";
				playsound("negative.mp3", "");
			}
			//while (_kbhit()) _getch();
			//cin >> vibor;
			//int tmp = 0;
			//while (!cin.good() || (vibor < 1 && vibor > 9) || fishkibili.find(vibor) == fishkibili.end())
			//{
			//	if (vibor > 0 && vibor < 10 && fishkibili.find(vibor) == fishkibili.end())
			//	{
			//		cout << "щРС ТХЬЙС СФЕ БГЪКХ. бШАЕПХРЕ ДПСЦСЧ." << endl;
			//	}
			//	else
			//	{
			//		if (tmp == 40)
			//			exit(0);
			//		if (tmp > 20)
			//			cout << "щРН МЕ ЙКХЙЙЕП! дН ОЕПЕЦПЕБЮ: " << 40 - tmp << endl;
			//		else if (tmp > 5)
			//			cout << "мС ЙЮЙ РЮЙ-РН? рШ МЕ ЛНФЕЬЭ ОНОЮЯРЭ ОН ЙМНОЙЕ СФЕ БНР ЯРНКЭЙН ПЮГ: " << tmp << endl;
			fishkibili.erase(vibor);
			hod ? player.insert(vibor) : comp.insert(vibor);
			cout << "  уНПНЬН." << endl;
			if (hod)
				hod = false;
			else
				hod = true;
			
			//Sleep(1000);
		}

		system("cls");
		cout << namepicf;
		cout << "\n\n\n" << endl;
		cout << "  лемч\n\n\t1 - ЯШЦПЮРЭ ЕЫ╦ ПЮГ\n\t2 - БЕПМСРЭЯЪ Й БШАНПС ПЕФХЛЮ ХЦПШ\n\n";
		string text = namepicf + "\n\n\n\n  лемч\n\n\t1 - ЯШЦПЮРЭ ЕЫ╦ ПЮГ\n\t2 - БЕПМСРЭЯЪ Й БШАНПС ПЕФХЛЮ ХЦПШ\n\n  оНУНФЕ БШ ББЕКХ ВРН-РН МЕ РН. оНОПНАСИРЕ ЕЫЕ ПЮГНЙ.\n  ";
		vibor = read(text, 1, 2);
		if (vibor == 2)
			break;
	}
}

void startgamefishki()
{
	if (music)
	{
		mciSendString(L"open \"audio/5.mp3\" alias gfive", NULL, 0, NULL);
		mciSendString(L"play gfive repeat", NULL, 0, NULL);
		//mciSendString(L"setaudio gfive volume to 100", NULL, 0, NULL);
	}
	while (true)
	{
		system("cls");

		//string temp = formnumber();
		string text = namepicf + "\n\n\n\n  лемч\n\n\t1 - МЮВЮРЭ ХЦПС\n\t2 - ОНЛНЫЭ\n\t3 - Б ЦКЮБМНЕ ЛЕМЧ\n\n  оНУНФЕ БШ ББЕКХ ВРН-РН МЕ РН. оНОПНАСИРЕ ЕЫЕ ПЮГНЙ.\n  ";
		cout << namepicf;
		cout << "\n\n\n\n";
		//cout << "  хЦПЮ \"сЦЮДЮИ ВХЯКН\"\n" << endl;
		cout << "  лемч\n\n\t1 - МЮВЮРЭ ХЦПС\n\t2 - ОНЛНЫЭ\n\t3 - Б ЦКЮБМНЕ ЛЕМЧ\n\n";
		int vibor = read(text, 1, 3);
		if (vibor == 1)
		{
			while (true)
			{
				system("cls");
				string text = namepicf + "\n\n\n\n  бшаепхре пефхл хцпш\n\n\t1 - Я ЙНЛОЭЧРЕПНЛ\n\t2 - БДБНЕЛ Я ДПСЦНЛ (ХКХ МЕ ДПСЦНЛ)\n\t3 - МЮГЮД\n\n  оНУНФЕ БШ ББЕКХ ВРН-РН МЕ РН. оНОПНАСИРЕ ЕЫЕ ПЮГНЙ.\n  ";
				cout << namepicf;
				cout << "\n\n\n" << endl;
				cout << "  бшаепхре пефхл хцпш\n\n\t1 - Я ЙНЛОЭЧРЕПНЛ\n\t2 - БДБНЕЛ Я ДПСЦНЛ (ХКХ МЕ ДПСЦНЛ)\n\t3 - МЮГЮД\n\n";
				int vibor = read(text, 1, 3);
				if (vibor == 1)
					PVI3();
				else if (vibor == 2)
					PVP3();
				else if (vibor == 3)
					break;
			}
		}

		else if (vibor == 2)
		{
			system("cls");
			//string temp = formnumber();
			cout << namepicf;
			cout << "\n\n\n" << endl;
			cout << "  опюбхкю. " << endl << endl;
			cout << "  мЮ БХПРСЮКЭМНЛ ЯРНКЕ КЕФЮР ТХЬЙХ Я ЖХТПЮЛХ 1, 2, 3, 4, 5, 6, 7, 8, 9.\n  дБЮ ХЦПНЙЮ ОН НВЕПЕДХ АЕПСР ТХЬЙХ (ГЮ ЙЮФДШИ УНД ЛНФМН БГЪРЭ РНКЭЙН НДМС ТХЬЙС).\n  бШХЦПШБЮЕР РНР ХЦПНЙ, ЙНРНПШИ ОЕПБШЛ ЯНАЕП╦Р С ЯЕАЪ РПХ ТХЬЙХ Я ЯСЛЛНИ 15.\n  еЯКХ МХ С НДМНЦН ХЦПНЙЮ РЮЙХУ ТХЬЕЙ МЕ АСДЕР, ТХЙЯХПСЕРЯЪ МХВЭЪ.\n  бЯЕ ОПНЯРН.\n\n  ";
			system("pause");
		}

		else if (vibor == 3)
			break;
	}
	mciSendString(L"close gfive", NULL, 0, NULL);
}